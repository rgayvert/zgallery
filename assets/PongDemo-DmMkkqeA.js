var P=Object.defineProperty;var v=(s,i,t)=>i in s?P(s,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[i]=t;var a=(s,i,t)=>(v(s,typeof i!="symbol"?i+"":i,t),t);import{a as n,ab as d,P as V,l as g,V as u,a8 as m,j as w,f,b as c,B as S,ad as M,bm as b,g as B,aO as k,p as A,bq as O,G as D}from"./index-Ch6aEO-x.js";import{S as x,A as G}from"./Animator-B_d2TEbQ.js";class I extends x{constructor(){super(...arguments);a(this,"rect",n(()=>d(this.location.get().x,this.location.get().y,16,16)))}}class y extends x{constructor(t,r,l,e){super(V(t,200));a(this,"rect",n(()=>d(this.x,this.location.get().y,16,80)));this.x=t,this.ball=r,this.autoplay=l,this.pointerY=e,l&&(this.bounds=d(0,0,640,400))}step(t,r){var p;super.step(t,r);let l;const e=this.ball.location.get(),o=this.ball.velocity.get();if(this.autoplay)if(o.x>0)l=240;else{const h=e.y-e.x*o.y/o.x;l=h<0||h>440?240:h}else l=(p=this.pointerY)==null?void 0:p.get();if(l){const h=g.clamp(l,20,460)-this.rect.get().center.y;this.velocity.set(u(0,g.clamp(h*.01,-.5,.5)))}}}class Y extends G{constructor(){super();a(this,"blocks",g.sequence(0,15).map(t=>d(312,t*32+8,16,16)));a(this,"startingVelocity",u(.3,0));a(this,"ball",new I(g.randomElement(this.blocks).origin,this.startingVelocity));a(this,"pointerY",n(200));a(this,"paddles",[new y(24,this.ball,!0),new y(616,this.ball,!1,this.pointerY)]);a(this,"scores",g.sequence(0,2).map(t=>n(0)));a(this,"gameOver",n(()=>this.scores[0].get()===10||this.scores[1].get()===10,{action:t=>t&&this.stop()}));this.setItems([this.ball,...this.paddles]),this.ball.location.addAction(()=>this.ballMoved())}start(){super.start(),this.scores.forEach(t=>t.set(0))}initializeBall(){this.ball.location.set(g.randomElement(this.blocks).origin),this.startingVelocity=this.startingVelocity.scalarMultiply(-1),this.ball.velocity.set(this.startingVelocity)}ballMoved(){const t=this.ball.rect.get();t.intersects(this.paddles[0].rect.get())?this.bounceOffPaddle(this.paddles[0],!0,t):t.intersects(this.paddles[1].rect.get())?this.bounceOffPaddle(this.paddles[1],!1,t):t.top<0||t.bottom>480?this.bounceOffWall():t.left<0?(m(this.scores[1]),this.initializeBall()):t.right>640&&(m(this.scores[0]),this.initializeBall())}bounceOffWall(){const t=this.ball.velocity.get();this.ball.velocity.set(u(t.x,-t.y))}bounceOffPaddle(t,r,l){const e=(t.rect.get().center.y-l.center.y)/t.rect.get().height,o=Math.PI*.7,p=this.ball.velocity.get(),h=r?-e*o:Math.PI+e*o;this.ball.velocity.set(p.withAngle(h))}}function z(){const s=new Y;function i(){return b({rect:d(0,0,16,16),fill:c.color.red,transform:n(()=>`translate(${s.ball.location.get().x}px, ${s.ball.rect.get().y}px`)})}function t(e){return b({rect:e.rect.get().translateToOrigin(),fill:c.color.blue,transform:n(()=>`translate(${e.rect.get().x}px, ${e.rect.get().y}px`)})}function r(e,o){return k(e,{x:o===0?270:370,y:64,fontSize:A(64),textAnchor:"middle",fill:c.color.white})}function l(){return b({x:0,y:0,width:640,height:480,fill:c.color.black,events:{pointerMove:e=>s.pointerY.set(O(e).y)}})}return w({width:f(100),gap:c.space.s8}).append(S({width:f(90),padding:c.space.s4,background:c.color.gray}).append(M({width:f(100),bounds:d(0,0,640,480)}).append(l(),...s.blocks.map(e=>b({rect:e,fill:c.color.white})),...s.scores.map((e,o)=>r(n(()=>e.get().toString()),o)),i(),...s.paddles.map(e=>t(e)))),B({label:n(()=>s.isRunning?"Stop":"Start"),action:()=>s.isRunning?s.stop():s.start()}))}function F(){return D(R)}const R={sourceDir:"/source/Demos/Pong",sections:[{title:"Pong",componentFn:z,sources:["PongItems.ts","PongModel.ts","Pong.ts"],markdown:"Pong.md"}]};export{F as PongDemo,F as default};
