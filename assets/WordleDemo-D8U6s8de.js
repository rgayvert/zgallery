var T=Object.defineProperty;var k=(t,e,s)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var o=(t,e,s)=>(k(t,typeof e!="symbol"?e+"":e,s),s);import{q as p,cl as h,a,o as y,r as C,ay as E,k as c,z as u,V as f,c as r,H as m,C as x,e as l,ai as b,s as B,d as I,h as L,bY as S,cm as R,ac as G,f as A,ae as M,bT as D,B as K,D as w,aA as O,au as P,G as v}from"./index-CHxjcGI-.js";const d=class d{constructor(){o(this,"allWords",[]);o(this,"wordsByLength",new Map);o(this,"wordLength",5);o(this,"numberOfGuesses",6);o(this,"guesses",Array(this.numberOfGuesses));o(this,"matchedRow",p(-1));o(this,"currentRow",p(0));o(this,"currentIndex",0);o(this,"wordToMatch","");o(this,"keysSeenInCorrectSpot",h());o(this,"keysSeenInWrongSpot",h());o(this,"unusedLetters",h());o(this,"status",a("Enter guess #1"));o(this,"gameInProgress",a(!1,{name:"gameInProgress"}));o(this,"newGameButtonLabel",a("Loading..."));o(this,"loadAtom",y(C("wordle/2of12inf.txt"),{action:()=>this.load()}));o(this,"toastItems",E([],{maxLength:1}));for(let e=0;e<this.numberOfGuesses;e++)this.guesses[e]=c.sequence(0,this.wordLength).map(s=>a(""))}wordOnRow(e){return e<this.numberOfGuesses?this.guesses[e].map(s=>s.get()).join(""):""}currentWord(){return this.wordOnRow(this.currentRow.get())}validInput(e){return d.validLetters.includes(e)||e==="ENTER"||e==="DELETE"||e==="BACKSPACE"}keyClicked(e){if(e=e.toUpperCase(),!this.validInput(e))return;const s=this.currentWord();e==="DELETE"||e==="BACKSPACE"?s.length>0&&(this.currentIndex--,this.guessAtIndex(this.currentIndex).set("")):e==="ENTER"&&s.length===this.wordLength?this.currentWordIsKnown()&&this.submitWord(s):e==="ENTER"?u.info("Too short"):s.length<this.wordLength&&(this.guessAtIndex(this.currentIndex).set(e),this.currentIndex++)}acceptWord(e){[...e].forEach((s,n)=>{s===this.wordToMatch[n]?this.keysSeenInCorrectSpot.add(s):this.wordToMatch.includes(s)?this.keysSeenInWrongSpot.add(s):this.unusedLetters.add(s)}),this.status.set(`Enter guess #${this.currentRow.get()+2}`)}currentWordIsKnown(){const e=this.wordsByLength.get(this.wordLength);return e&&e.includes(this.currentWord().toLowerCase())}submitWord(e){this.acceptWord(e),this.currentRow.increment(),this.matchedRow.increment(),e===this.wordToMatch?(this.toastItems.addValue("You Won! 🏆"),this.gameInProgress.set(!1)):this.currentRow.get()===this.numberOfGuesses&&e!==this.wordToMatch&&(this.toastItems.addValue(`The word was ${this.wordToMatch}.`),this.gameInProgress.set(!1))}guessAtIndex(e){const[s,n]=this.indexToRowCol(e);return this.guesses[s][n]}indexToRowCol(e){const s=Math.floor(e/this.wordLength);return[s,e-s*this.wordLength]}pickWordToMatch(){const e=this.wordsByLength.get(this.wordLength);this.wordToMatch=e[c.randomInt(0,e.length-1)].toUpperCase(),this.gameInProgress.set(!0),u.info("word to match: "+this.wordToMatch)}newGame(){this.guesses.forEach(e=>e.forEach(s=>s.set(""))),this.matchedRow.set(-1),this.currentRow.set(0),this.currentIndex=0,this.keysSeenInCorrectSpot.clear(),this.keysSeenInWrongSpot.clear(),this.unusedLetters.clear(),this.pickWordToMatch(),this.toastItems.addValue("Guess the word")}load(){this.allWords=this.loadAtom.get().split(/\r\n?|\n/).filter(e=>!e.endsWith("%")),u.info(`Loaded ${this.allWords.length} words`),this.newGameButtonLabel.set("New Game"),this.allWords.forEach(e=>{let s=this.wordsByLength.get(e.length);s||(s=[],this.wordsByLength.set(e.length,s)),s.push(e)}),this.pickWordToMatch()}};o(d,"validLetters","ABCDEFGHIJKLMNOPQRSTUVWXYZ");let g=d;function V(t,e,s){const n=t.currentWord().length===t.wordLength,i=t.currentWordIsKnown();return e===t.currentRow.get()&&n&&!i?r.color.red:r.color.black}function N(t,e,s){const n=t.guesses[e][s].get();return e>t.matchedRow.get()?r.color.lightgray:t.wordToMatch[s]===n?r.color.green:n&&t.wordToMatch.includes(n)?r.color.orange:I({rgba:"#a4aec4"})}function U(t,e,s){return x(t.guesses[e][s],{font:r.font.headline_medium,width:l(1.5),height:l(1.5),border:r.border.thin,borderRadius:b(1),color:a(()=>V(t,e)),effects:{contentChanged:B.pop()},background:a(()=>N(t,e,s))})}function H(t){return f({gap:r.space.s3}).append(...c.sequence(0,t.numberOfGuesses).map(e=>m({justifyContent:"stretch",gap:r.space.s3}).append(...c.sequence(0,t.wordLength).map(s=>U(t,e,s)))))}function q(t={}){const e=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Delete","Z","X","C","V","B","N","M","Enter"]];function s(n){return L({label:n,action:()=>{var i;return(i=t.action)==null?void 0:i.call(t,n)},disabled:t.disabled,borderRadius:b(1),border:r.border.thin,color:r.color.black,background:a(()=>t.keyBackground?t.keyBackground(n):r.color.secondary.contrast),flex:n.length===1?S({grow:1,shrink:1}):void 0,minWidth:l(1.5),effects:R(),name:n})}return f({gap:r.space.s3}).append(...e.map((n,i)=>m({gap:r.space.s3}).append(...e[i].map(W=>s(W)))))}function Y(t,e){return t.gameInProgress.get()?t.keysSeenInCorrectSpot.get().has(e)?r.color.green:t.keysSeenInWrongSpot.get().has(e)?r.color.orange:t.unusedLetters.get().has(e)?I({rgba:"#a4aec4"}):r.color.lightgray:r.color.lightgray}function z(t){return q({disabled:a(()=>!t.gameInProgress.get(),{name:"keyboard-disabled"}),action:e=>t.keyClicked(e),keyBackground:e=>Y(t,e)})}G("Wordle","Box",{height:A(100),font:r.font.headline_medium,position:"relative",onIntersectionVisible:t=>t.focus(),outline:r.border.none,padding:r.space.s5});function F(t,e){t.gameInProgress.get()&&t.keyClicked(e.key.toUpperCase())}function $(t){return L({label:t.newGameButtonLabel,padding:r.space.s2,font:r.font.title_medium,color:r.color.darkgray,background:r.color.lightgray,rounding:r.rounding.pill,action:()=>t.newGame()})}function j(t={}){const e=M("Wordle",t),s=new g;return e.model=s,D(e,{keyDown:n=>F(s,n)}),K(e).append(f({gap:r.space.s3}).append(H(s),w(r.space.s5),z(s),w(r.space.s5),$(s)),O(s.toastItems,{placement:P.center,maxItems:1,duration:1500}))}function Z(){return v(J)}const J={sourceDir:"/source/Demos/Wordle",sections:[{title:"Wordle",componentFn:j,sources:["Wordle.ts","WordleModel.ts","Keyboard.ts","WordleKeyboard.ts","WordleGuesses.ts"],markdown:"Wordle.md"}]};export{Z as WordleDemo,Z as default};
