var v=Object.defineProperty;var O=(o,t,e)=>t in o?v(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(O(o,typeof t!="symbol"?t+"":t,e),e);import{cf as j,aF as B,a as d,c7 as I,ay as V,aN as x,H as D,f as h,c as r,h as _,aq as b,a4 as k,ac as y,ae as $,c5 as N,a3 as U,cc as P,bQ as A,e as F,V as T,aj as M,cg as H,s as R,l as L,D as w,a5 as W,m as E,ah as q,B as z,bl as C,aA as G,au as J,G as Q}from"./index-BldBqEEL.js";class K extends j{constructor(t,e,s){super(e,s),this.baseURL=t,this.ex=s}toString(){return`FetchTableStore[${this.baseURL}]`}async create(t){var a,n;t.prepareToSave();const{recordID:e,...s}=this.instanceToPlain(t),c={method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}};try{const i=await fetch(this.baseURL,c);if(i.ok){const m=await i.json();t.recordID=m.recordID}else(a=this.ex)==null||a.push(`${this.toString()}/create: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/create: fetch failed`,i)}}async get(t,e){var a,n;const s={method:"GET"},c=`${this.baseURL}/${e}`;try{const i=await fetch(c,s);if(i.ok){const m=await i.json(),p=this.plainToInstance(m);p&&t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/get: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/get: fetch failed`,i)}}async getAll(t,e,s){var a,n;const c={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}};try{const i=await fetch(`${this.baseURL}/all`,c);if(i.ok){const p=(await i.json()).map(g=>this.plainToInstance(g));s?s==null||s(p):p.forEach(g=>g.restore()),t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/getAll: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/getAll: fetch failed`,i)}}async update(t){var c,a;t.prepareToSave();const e={method:"PUT",body:JSON.stringify(this.instanceToPlain(t)),headers:{"Content-Type":"application/json"}},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok||(c=this.ex)==null||c.push(`${this.toString()}/update: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/update: fetch failed`,n)}}async delete(t){var c,a;const e={method:"DELETE"},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok?this.removeRecord(t):(c=this.ex)==null||c.push(`${this.toString()}/getAll: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/getAll: fetch failed`,n)}}}class X{constructor(t){this.list=t}push(t,e){this.list.addValue(t),console.log(t)}}var u=(o=>(o.All="All",o.Active="Active",o.Completed="Completed",o))(u||{});class f extends B{constructor(e,s="",c=!1){super(e);l(this,"recordID",-1);this.content=s,this.completed=c}}var Y={VITE_ROUTER:"hash",VITE_BASE_URL:"/zgallery",BASE_URL:"/zgallery/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};class S{constructor(t=S.defaultStore()){l(this,"newText",d("",{action:t=>this.createNewText(t)}));l(this,"filterNames",[u.All,u.Active,u.Completed]);l(this,"currentFilterName",d(u.All));l(this,"count");l(this,"activeCount",d(0));l(this,"filteredRecords");l(this,"completedCount");l(this,"records");l(this,"toastItems",V([],{maxLength:1}));l(this,"ex",new X(this.toastItems));this.store=t,this.records=t.createRecordList(),this.count=d(()=>this.countText()),this.filteredRecords=d(()=>this.getFilteredRecords()),this.completedCount=d(0),this.records.addAll(),this.adjustCompletedCount()}static defaultStore(){return new I("todo",f)}setStore(t){this.store=t,this.records=t.createRecordList(),this.records.addAll()}adjustCompletedCount(){this.completedCount.set(this.records.count(t=>t.completed))}remoteStore(){return Y.VITE_TODO_REMOTE}changeStore(t){this.setStore(t==="Local"?new I("todo",f):new K(this.remoteStore(),f,this.ex))}itemMatchesCurrentFilter(t){const e=this.currentFilterName.get();return e===u.All||x(t.completed)&&e===u.Completed||!x(t.completed)&&e===u.Active}getFilteredRecords(){return this.records.filter(t=>this.itemMatchesCurrentFilter(t))}countText(){const t=this.getFilteredRecords().length;return`${t} item${t===1?"":"s"} left`}createNewText(t){t.trim()&&(this.records.add(new f(this.store,t)),this.newText.set(""))}toggleAllItems(){const t=this.completedCount.get()<this.records.length;this.records.forEach(e=>e.completed=t)}clearCompletedItems(){this.records.deleteAll(...this.records.filter(t=>t.completed))}itemCount(){return this.records.length}deleteRecord(t){this.records.delete(t),t.delete()}}function Z(o){return D({width:h(100),alignItems:"center",paddingBlockStart:r.space.s3}).append(_({leadingIconURI:"icon.chevron-down",font:r.font.headline_medium,title:"Toggle All",padding:r.space.s0,action:()=>o.toggleAllItems(),border:r.border.none}),b(o.newText,{font:r.font.title_medium,placeholder:"What needs to be done?",firstFocus:!0,setOnInput:!1,readOnly:!1,width:h(100)}))}function tt(o){const t=d("Local",{action:s=>o.changeStore(s)}),e=["Local","Remote"];if(o.remoteStore())return k(t,e,e,{flexDirection:"row",radioButtonOptions:{onIcon:"icon.square-box-filled",offIcon:"icon.square-box-outlined"}})}y("ToDoItemRow","Box",{width:h(100),padding:r.space.s0,alignItems:"center",justifyContent:"center"});function et(o,t,e={}){const s=$("ToDoItemRow",e),c=d(!0),a={hovered:d(!1)};s.sharedState=a,s.componentName="ToDoItemRow",s.model=[t,o];const n=N(o,!0);return n.completed.addAction(()=>t.adjustCompletedCount()),D(s).append(U(n.completed,{font:r.font.headline_medium}),b(n.content,{readOnly:c,width:P("100% - 5em"),textDecoration:d(()=>n.completed.get()?"line-through":""),outlineWhenEdited:!0,editOnDoubleClick:!0}),A("x",{hidden:d(()=>{var i;return!((i=a.hovered)!=null&&i.get())}),position:"absolute",right:F(.1),font:r.font.title_medium,action:()=>t.deleteRecord(o)}))}function ot(o,t,e){return et(t,o,{id:`item-${t.recordID}`,maxWidth:e,effects:{mounted:H(R.fadeIn("in"),R.slide("out","left",.3))}})}function st(o,t){return T({width:h(100)}).append(M(o.filteredRecords,e=>`item-${e.recordID}`,e=>ot(o,e,t)))}function nt(o){return D({hidden:d(()=>o.itemCount()===0),font:r.font.body_medium,width:h(100),padding:r.space.s4}).append(L(o.count,{rounding:r.rounding.r0}),w(1),W(o.currentFilterName,o.filterNames,{rounding:r.rounding.r0}),w(1),A("Clear Completed",{action:()=>o.clearCompletedItems(),hidden:d(()=>o.completedCount.get()===0)}))}y("ToDo","Page",{maxWidth:E(100),width:h(100)});function it(o={}){const t=$("ToDo",o),e=new S;t.model=e;const s={width:h(100),rounding:r.rounding.r3,elevation:5,alignItems:"center",overflow:"hidden",border:r.border.thin};return q(t).append(z({padding:r.space.s6}).append(T({width:h(100),alignItems:"center"}).append(L("todos",{font:r.font.display_medium}),T(s).append(Z(e),C({width:h(95)}),st(e,t.maxWidth||E(100)),C({width:h(99)}),nt(e)),w(r.space.s6),tt(e))),G(e.toastItems,{placement:J.center,maxItems:1,duration:1500}))}function dt(){return Q(at)}const at={sourceDir:"/source/Demos/ToDo",sections:[{title:"ToDo",componentFn:()=>it(),sources:["View/ToDo.ts","View/ToDoButtonBar.ts","View/ToDoInputRow.ts","View/ToDoItemList.ts","View/ToDoItemRow.ts","View/ToDoStoreSelector.ts","Model/ToDoModel.ts","Data/ToDoData.ts"],markdown:"ToDo.md"}]};export{dt as ToDoDemo,dt as default};
