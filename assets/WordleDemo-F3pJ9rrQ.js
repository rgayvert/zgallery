var y=Object.defineProperty;var B=(n,e,t)=>e in n?y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(B(n,typeof e!="symbol"?e+"":e,t),t);import{q as I,cd as f,a as d,o as R,r as A,ax as G,l as u,z as w,j as W,b as s,H as T,g as k,ah as C,bU as M,e as l,ce as O,aa as D,f as P,ac as v,ae as K,B as b,x as U,az as V,d as L,C as N,t as F,at as H,G as q}from"./index-aIMxXOu_.js";const g=class g{constructor(){r(this,"allWords",[]);r(this,"wordsByLength",new Map);r(this,"wordLength",5);r(this,"numberOfGuesses",6);r(this,"guesses",Array(this.numberOfGuesses));r(this,"matchedRow",I(-1));r(this,"currentRow",I(0));r(this,"currentIndex",0);r(this,"wordToMatch","");r(this,"keysSeenInCorrectSpot",f());r(this,"keysSeenInWrongSpot",f());r(this,"unusedLetters",f());r(this,"status",d("Enter guess #1"));r(this,"gameInProgress",d(!1,{name:"gameInProgress"}));r(this,"newGameButtonLabel",d("Loading..."));r(this,"loadAtom",R(A("wordle/2of12inf.txt"),{action:()=>this.load()}));r(this,"toastItems",G([],{maxLength:1}));for(let e=0;e<this.numberOfGuesses;e++)this.guesses[e]=u.sequence(0,this.wordLength).map(t=>d(""))}wordOnRow(e){return e<this.numberOfGuesses?this.guesses[e].map(t=>t.get()).join(""):""}currentWord(){return this.wordOnRow(this.currentRow.get())}validInput(e){return g.validLetters.includes(e)||e==="ENTER"||e==="DELETE"||e==="BACKSPACE"}keyClicked(e){if(e=e.toUpperCase(),!this.validInput(e))return;const t=this.currentWord();e==="DELETE"||e==="BACKSPACE"?t.length>0&&(this.currentIndex--,this.guessAtIndex(this.currentIndex).set("")):e==="ENTER"&&t.length===this.wordLength?this.currentWordIsKnown()&&this.submitWord(t):e==="ENTER"?w.info("Too short"):t.length<this.wordLength&&(this.guessAtIndex(this.currentIndex).set(e),this.currentIndex++)}acceptWord(e){[...e].forEach((t,a)=>{t===this.wordToMatch[a]?this.keysSeenInCorrectSpot.add(t):this.wordToMatch.includes(t)?this.keysSeenInWrongSpot.add(t):this.unusedLetters.add(t)}),this.status.set(`Enter guess #${this.currentRow.get()+2}`)}currentWordIsKnown(){const e=this.wordsByLength.get(this.wordLength);return e&&e.includes(this.currentWord().toLowerCase())}submitWord(e){this.acceptWord(e),this.currentRow.increment(),this.matchedRow.increment(),e===this.wordToMatch?(this.toastItems.addValue("You Won! 🏆"),this.gameInProgress.set(!1)):this.currentRow.get()===this.numberOfGuesses&&e!==this.wordToMatch&&(this.toastItems.addValue(`The word was ${this.wordToMatch}.`),this.gameInProgress.set(!1))}guessAtIndex(e){const[t,a]=this.indexToRowCol(e);return this.guesses[t][a]}indexToRowCol(e){const t=Math.floor(e/this.wordLength);return[t,e-t*this.wordLength]}pickWordToMatch(){const e=this.wordsByLength.get(this.wordLength);this.wordToMatch=e[u.randomInt(0,e.length-1)].toUpperCase(),this.gameInProgress.set(!0),w.info("word to match: "+this.wordToMatch)}newGame(){this.guesses.forEach(e=>e.forEach(t=>t.set(""))),this.matchedRow.set(-1),this.currentRow.set(0),this.currentIndex=0,this.keysSeenInCorrectSpot.clear(),this.keysSeenInWrongSpot.clear(),this.unusedLetters.clear(),this.pickWordToMatch(),this.toastItems.addValue("Guess the word")}load(){this.allWords=this.loadAtom.get().split(/\r\n?|\n/).filter(e=>!e.endsWith("%")),w.info(`Loaded ${this.allWords.length} words`),this.newGameButtonLabel.set("New Game"),this.allWords.forEach(e=>{let t=this.wordsByLength.get(e.length);t||(t=[],this.wordsByLength.set(e.length,t)),t.push(e)}),this.pickWordToMatch()}};r(g,"validLetters","ABCDEFGHIJKLMNOPQRSTUVWXYZ");let p=g;function z(n={}){const e=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Delete","Z","X","C","V","B","N","M","Enter"]];function t(a){return k({label:a,disabled:n.disabled,borderRadius:C(1),border:s.border.thin,color:s.color.black,background:d(()=>n.keyBackground?n.keyBackground(a):s.color.secondary.contrast),action:()=>{var c;return(c=n.action)==null?void 0:c.call(n,a)},flex:a.length===1?M({grow:1,shrink:1}):void 0,minWidth:l(1.5),effects:O(),name:a})}return W({gap:s.space.s3}).append(...e.map((a,c)=>T({gap:s.space.s3}).append(...e[c].map(m=>t(m)))))}D("Wordle","Box",{height:P(100),font:s.font.headline_medium,position:"relative",onIntersectionVisible:n=>n.focus(),outline:s.border.none,padding:s.space.s5});function j(n={}){const e=v("Wordle",n),t=new p;e.model=t,K(e,{keyDown:o=>a(o)});function a(o){t.gameInProgress.get()&&t.keyClicked(o.key.toUpperCase())}function c(o,i){const h=t.currentWord().length===t.wordLength,S=t.currentWordIsKnown();return o===t.currentRow.get()&&h&&!S?s.color.red:s.color.black}function m(o,i){const h=t.guesses[o][i].get();return o>t.matchedRow.get()?s.color.lightgray:t.wordToMatch[i]===h?s.color.green:h&&t.wordToMatch.includes(h)?s.color.orange:L({rgba:"#a4aec4"})}function x(o){return t.gameInProgress.get()?t.keysSeenInCorrectSpot.get().has(o)?s.color.green:t.keysSeenInWrongSpot.get().has(o)?s.color.orange:t.unusedLetters.get().has(o)?L({rgba:"#a4aec4"}):s.color.lightgray:s.color.lightgray}function E(o,i){return N(t.guesses[o][i],{font:s.font.headline_medium,width:l(1.5),height:l(1.5),border:s.border.thin,borderRadius:C(1),color:d(()=>c(o)),effects:{contentChanged:F.pop()},background:d(()=>m(o,i))})}return b(e).append(W({gap:s.space.s3}).append(...u.sequence(0,t.numberOfGuesses).map(o=>T({justifyContent:"stretch",gap:s.space.s3}).append(...u.sequence(0,t.wordLength).map(i=>E(o,i)))),b({height:l(1)}),z({disabled:d(()=>!t.gameInProgress.get(),{name:"keyboard-disabled"}),action:o=>t.keyClicked(o),keyBackground:o=>x(o)}),U(s.space.s7),k({label:t.newGameButtonLabel,padding:s.space.s2,font:s.font.title_medium,color:s.color.darkgray,background:s.color.lightgray,rounding:s.rounding.pill,action:()=>t.newGame()})),V(t.toastItems,{placement:H.center,maxItems:1,duration:1500}))}function Q(){return q(Y)}const Y={sourceDir:"/source/Demos/Wordle",sections:[{title:"Wordle",componentFn:j,sources:["Wordle.ts","WordleModel.ts","Keyboard.ts"],markdown:"Wordle.md"}]};export{Q as WordleDemo,Q as default};
