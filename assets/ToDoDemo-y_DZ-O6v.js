var v=Object.defineProperty;var O=(o,t,e)=>t in o?v(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(O(o,typeof t!="symbol"?t+"":t,e),e);import{cf as _,cg as B,aF as V,a as d,c7 as I,ay as j,aN as x,H as w,f as h,c as r,h as k,aq as C,a4 as N,ac as b,ae as E,c5 as U,a3 as P,cc as M,bQ as A,e as F,V as T,aj as G,s as R,l as $,D,a5 as H,m as L,ah as W,B as q,bl as y,aA as z,au as J,G as Q}from"./index-9pqxGvR_.js";class K extends _{constructor(t,e,s){super(e,s),this.baseURL=t,this.ex=s}toString(){return`FetchTableStore[${this.baseURL}]`}async create(t){var a,n;t.prepareToSave();const{recordID:e,...s}=this.instanceToPlain(t),c={method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}};try{const i=await fetch(this.baseURL,c);if(i.ok){const f=await i.json();t.recordID=f.recordID}else(a=this.ex)==null||a.push(`${this.toString()}/create: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/create: fetch failed`,i)}}async get(t,e){var a,n;const s={method:"GET"},c=`${this.baseURL}/${e}`;try{const i=await fetch(c,s);if(i.ok){const f=await i.json(),p=this.plainToInstance(f);p&&t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/get: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/get: fetch failed`,i)}}async getAll(t,e,s){var a,n;const c={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}};try{const i=await fetch(`${this.baseURL}/all`,c);if(i.ok){const p=(await i.json()).map(g=>this.plainToInstance(g));s?s==null||s(p):p.forEach(g=>g.restore()),t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/getAll: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/getAll: fetch failed`,i)}}async update(t){var c,a;t.prepareToSave();const e={method:"PUT",body:JSON.stringify(this.instanceToPlain(t)),headers:{"Content-Type":"application/json"}},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok||(c=this.ex)==null||c.push(`${this.toString()}/update: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/update: fetch failed`,n)}}async delete(t){var c,a;const e={method:"DELETE"},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok?this.removeRecord(t):(c=this.ex)==null||c.push(`${this.toString()}/getAll: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/getAll: fetch failed`,n)}}}class X{constructor(t){this.list=t}push(t,e){this.list.addValue(t),console.log(t)}}function Y(o,t){return new Z(o,t)}class Z extends B{constructor(t,e){super("in&out"),this.inEffect=t,this.outEffect=e}applyToTarget(t,e,s){return e==="in"?this.inEffect.applyToTarget(t,"in",s):this.outEffect.applyToTarget(t,"out",s)}}var u=(o=>(o.All="All",o.Active="Active",o.Completed="Completed",o))(u||{});class m extends V{constructor(e,s="",c=!1){super(e);l(this,"recordID",-1);this.content=s,this.completed=c}}var tt={VITE_ROUTER:"hash",VITE_BASE_URL:"/zgallery",BASE_URL:"/zgallery/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,VITE_BUILD_DATE:"Mon Sep 30 2024 08:48:01 GMT-0400 (Eastern Daylight Time)"};class S{constructor(t=S.defaultStore()){l(this,"newText",d("",{action:t=>this.createNewText(t)}));l(this,"filterNames",[u.All,u.Active,u.Completed]);l(this,"currentFilterName",d(u.All));l(this,"count");l(this,"activeCount",d(0));l(this,"filteredRecords");l(this,"completedCount");l(this,"records");l(this,"toastItems",j([],{maxLength:1}));l(this,"ex",new X(this.toastItems));this.store=t,this.records=t.createRecordList(),this.count=d(()=>this.countText()),this.filteredRecords=d(()=>this.getFilteredRecords()),this.completedCount=d(0),this.records.addAll(),this.adjustCompletedCount()}static defaultStore(){return new I("todo",m)}setStore(t){this.store=t,this.records=t.createRecordList(),this.records.addAll()}adjustCompletedCount(){this.completedCount.set(this.records.count(t=>t.completed))}remoteStore(){return tt.VITE_TODO_REMOTE}changeStore(t){this.setStore(t==="Local"?new I("todo",m):new K(this.remoteStore(),m,this.ex))}itemMatchesCurrentFilter(t){const e=this.currentFilterName.get();return e===u.All||x(t.completed)&&e===u.Completed||!x(t.completed)&&e===u.Active}getFilteredRecords(){return this.records.filter(t=>this.itemMatchesCurrentFilter(t))}countText(){const t=this.getFilteredRecords().length;return`${t} item${t===1?"":"s"} left`}createNewText(t){t.trim()&&(this.records.add(new m(this.store,t)),this.newText.set(""))}toggleAllItems(){const t=this.completedCount.get()<this.records.length;this.records.forEach(e=>e.completed=t)}clearCompletedItems(){this.records.deleteAll(...this.records.filter(t=>t.completed))}itemCount(){return this.records.length}deleteRecord(t){this.records.delete(t),t.delete()}}function et(o){return w({width:h(100),alignItems:"center",paddingBlockStart:r.space.s3}).append(k({leadingIconURI:"icon.chevron-down",font:r.font.headline_medium,title:"Toggle All",padding:r.space.s0,action:()=>o.toggleAllItems(),border:r.border.none}),C(o.newText,{font:r.font.title_medium,placeholder:"What needs to be done?",firstFocus:!0,setOnInput:!1,readOnly:!1,width:h(100)}))}function ot(o){const t=d("Local",{action:s=>o.changeStore(s)}),e=["Local","Remote"];if(o.remoteStore())return N(t,e,e,{flexDirection:"row",radioButtonOptions:{onIcon:"icon.square-box-filled",offIcon:"icon.square-box-outlined"}})}b("ToDoItemRow","Box",{width:h(100),padding:r.space.s0,alignItems:"center",justifyContent:"center"});function st(o,t,e={}){const s=E("ToDoItemRow",e),c=d(!0),a={hovered:d(!1)};s.sharedState=a,s.componentName="ToDoItemRow",s.model=[t,o];const n=U(o,!0);return n.completed.addAction(()=>t.adjustCompletedCount()),w(s).append(P(n.completed,{font:r.font.headline_medium}),C(n.content,{readOnly:c,width:M("100% - 5em"),textDecoration:d(()=>n.completed.get()?"line-through":""),outlineWhenEdited:!0,editOnDoubleClick:!0}),A("x",{hidden:d(()=>{var i;return!((i=a.hovered)!=null&&i.get())}),position:"absolute",right:F(.1),font:r.font.title_medium,action:()=>t.deleteRecord(o)}))}function nt(o,t,e){return st(t,o,{id:`item-${t.recordID}`,maxWidth:e,effects:{mounted:Y(R.fadeIn("in"),R.slide("out","left",.3))}})}function it(o,t){return T({width:h(100)}).append(G(o.filteredRecords,e=>`item-${e.recordID}`,e=>nt(o,e,t)))}function at(o){return w({hidden:d(()=>o.itemCount()===0),font:r.font.body_medium,width:h(100),padding:r.space.s4}).append($(o.count,{rounding:r.rounding.none}),D(1),H(o.currentFilterName,o.filterNames,{rounding:r.rounding.none}),D(1),A("Clear Completed",{action:()=>o.clearCompletedItems(),hidden:d(()=>o.completedCount.get()===0)}))}b("ToDo","Page",{maxWidth:L(100),width:h(100)});function rt(o={}){const t=E("ToDo",o),e=new S;t.model=e;const s={width:h(100),rounding:r.rounding.r3,elevation:5,alignItems:"center",overflow:"hidden",border:r.border.thin};return W(t).append(q({padding:r.space.s6}).append(T({width:h(100),alignItems:"center"}).append($("todos",{font:r.font.display_medium}),T(s).append(et(e),y({width:h(95)}),it(e,t.maxWidth||L(100)),y({width:h(99)}),at(e)),D(r.space.s6),ot(e))),z(e.toastItems,{placement:J.center,maxItems:1,duration:1500}))}function ht(){return Q(ct)}const ct={sourceDir:"/source/Demos/ToDo",sections:[{title:"ToDo",componentFn:()=>rt(),sources:["View/ToDo.ts","View/ToDoButtonBar.ts","View/ToDoInputRow.ts","View/ToDoItemList.ts","View/ToDoItemRow.ts","View/ToDoStoreSelector.ts","Model/ToDoModel.ts","Data/ToDoData.ts"],markdown:"ToDo.md"}]};export{ht as ToDoDemo,ht as default};
