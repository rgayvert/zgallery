var V=Object.defineProperty;var B=(o,t,e)=>t in o?V(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(B(o,typeof t!="symbol"?t+"":t,e),e);import{cg as v,z as j,ch as N,aF as _,a as d,c8 as I,ay as k,aN as x,H as D,f as h,c as r,h as U,aq as C,a3 as P,ab as b,ad as E,c6 as M,ae as A,a2 as F,cd as z,bR as $,e as G,V as g,aj as H,s as R,l as L,D as w,a4 as W,m as O,ah as q,B as J,bm as y,aA as K,au as Q,G as X}from"./index-Kkg4vrHy.js";class Y extends v{constructor(t,e,s){super(e,s),this.baseURL=t,this.ex=s}toString(){return`FetchTableStore[${this.baseURL}]`}async create(t){var a,n;t.prepareToSave();const{recordID:e,...s}=this.instanceToPlain(t),c={method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}};try{const i=await fetch(this.baseURL,c);if(i.ok){const m=await i.json();t.recordID=m.recordID}else(a=this.ex)==null||a.push(`${this.toString()}/create: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/create: fetch failed`,i)}}async get(t,e){var a,n;const s={method:"GET"},c=`${this.baseURL}/${e}`;try{const i=await fetch(c,s);if(i.ok){const m=await i.json(),p=this.plainToInstance(m);p&&t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/get: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/get: fetch failed`,i)}}async getAll(t,e,s){var a,n;const c={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}};try{const i=await fetch(`${this.baseURL}/all`,c);if(i.ok){const p=(await i.json()).map(T=>this.plainToInstance(T));s?s==null||s(p):p.forEach(T=>T.restore()),t.set(p)}else(a=this.ex)==null||a.push(`${this.toString()}/getAll: ${i.status}`)}catch(i){(n=this.ex)==null||n.push(`${this.toString()}/getAll: fetch failed`,i)}}async update(t){var c,a;t.prepareToSave();const e={method:"PUT",body:JSON.stringify(this.instanceToPlain(t)),headers:{"Content-Type":"application/json"}},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok||(c=this.ex)==null||c.push(`${this.toString()}/update: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/update: fetch failed`,n)}}async delete(t){var c,a;const e={method:"DELETE"},s=`${this.baseURL}/${t.recordID}`;try{const n=await fetch(s,e);n.ok?this.removeRecord(t):(c=this.ex)==null||c.push(`${this.toString()}/getAll: ${n.status}`)}catch(n){(a=this.ex)==null||a.push(`${this.toString()}/getAll: fetch failed`,n)}}}class Z{constructor(t){this.list=t}push(t,e){this.list.addValue(t),j.info(t)}}function tt(o,t){return new et(o,t)}class et extends N{constructor(t,e){super("in&out"),this.inEffect=t,this.outEffect=e}applyToTarget(t,e,s){return e==="in"?this.inEffect.applyToTarget(t,"in",s):this.outEffect.applyToTarget(t,"out",s)}}var u=(o=>(o.All="All",o.Active="Active",o.Completed="Completed",o))(u||{});class f extends _{constructor(e,s="",c=!1){super(e);l(this,"recordID",-1);this.content=s,this.completed=c}}class S{constructor(t=S.defaultStore()){l(this,"newText",d("",{action:t=>this.createNewText(t)}));l(this,"filterNames",[u.All,u.Active,u.Completed]);l(this,"currentFilterName",d(u.All));l(this,"count");l(this,"activeCount",d(0));l(this,"filteredRecords");l(this,"completedCount");l(this,"records");l(this,"toastItems",k([],{maxLength:1}));l(this,"ex",new Z(this.toastItems));this.store=t,this.records=t.createRecordList(),this.count=d(()=>this.countText()),this.filteredRecords=d(()=>this.getFilteredRecords()),this.completedCount=d(0),this.records.addAll(),this.adjustCompletedCount()}static defaultStore(){return new I("todo",f)}setStore(t){this.store=t,this.records=t.createRecordList(),this.records.addAll()}adjustCompletedCount(){this.completedCount.set(this.records.count(t=>t.completed))}remoteStore(){return{VITE_ROUTER:"hash",VITE_BASE_URL:"/zgallery",BASE_URL:"/zgallery/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,VITE_BUILD_DATE:"Mon Oct 14 2024 07:47:57 GMT-0400 (Eastern Daylight Time)",VITE_VERSION:"Version 0.7.0"}.VITE_TODO_REMOTE}changeStore(t){this.setStore(t==="Local"?new I("todo",f):new Y(this.remoteStore(),f,this.ex))}itemMatchesCurrentFilter(t){const e=this.currentFilterName.get();return e===u.All||x(t.completed)&&e===u.Completed||!x(t.completed)&&e===u.Active}getFilteredRecords(){return this.records.filter(t=>this.itemMatchesCurrentFilter(t))}countText(){const t=this.getFilteredRecords().length;return`${t} item${t===1?"":"s"} left`}createNewText(t){t.trim()&&(this.records.add(new f(this.store,t)),this.newText.set(""))}toggleAllItems(){const t=this.completedCount.get()<this.records.length;this.records.forEach(e=>e.completed=t)}clearCompletedItems(){this.records.deleteAll(...this.records.filter(t=>t.completed))}itemCount(){return this.records.length}deleteRecord(t){this.records.delete(t),t.delete()}}function ot(o){return D({width:h(100),alignItems:"center",paddingBlockStart:r.space.s3}).append(U({leadingIconURI:"icon.chevron-down",font:r.font.headline_medium,title:"Toggle All",padding:r.space.s0,action:()=>o.toggleAllItems(),border:r.border.none}),C(o.newText,{font:r.font.title_medium,placeholder:"What needs to be done?",firstFocus:!0,setOnInput:!1,readOnly:!1,width:h(100)}))}function st(o){const t=d("Local",{action:s=>o.changeStore(s)}),e=["Local","Remote"];if(o.remoteStore())return P(t,e,e,{flexDirection:"row",radioButtonOptions:{onIcon:"icon.square-box-filled",offIcon:"icon.square-box-outlined"}})}b("ToDoItemRow","Box",{width:h(100),padding:r.space.s0,alignItems:"center",justifyContent:"center"});function nt(o,t,e={}){const s=E("ToDoItemRow",e),c=d(!0),a={hovered:d(!1)};s.sharedState=a,s.componentName="ToDoItemRow",s.model=[t,o];const n=M(o,!0);return n.completed.addAction(()=>t.adjustCompletedCount()),A(D(s).append(F(n.completed,{font:r.font.headline_medium}),C(n.content,{readOnly:c,width:z("100% - 5em"),textDecoration:d(()=>n.completed.get()?"line-through":""),outlineWhenEdited:!0,editOnDoubleClick:!0}),$("x",{hidden:d(()=>{var i;return!((i=a.hovered)!=null&&i.get())}),position:"absolute",right:G(.1),font:r.font.title_medium,action:()=>t.deleteRecord(o)})))}function it(o,t,e){return nt(t,o,{id:`item-${t.recordID}`,maxWidth:e,effects:{mounted:tt(R.fadeIn("in"),R.slide("out","left",.3))}})}function at(o,t){return g({width:h(100)}).append(H(o.filteredRecords,e=>`item-${e.recordID}`,e=>it(o,e,t)))}function rt(o){return D({hidden:d(()=>o.itemCount()===0),font:r.font.body_medium,width:h(100),padding:r.space.s4}).append(L(o.count,{rounding:r.rounding.none}),w(1),W(o.currentFilterName,o.filterNames,{rounding:r.rounding.none}),w(1),$("Clear Completed",{action:()=>o.clearCompletedItems(),hidden:d(()=>o.completedCount.get()===0)}))}b("ToDo","Page",{maxWidth:O(100),width:h(100)});function ct(o={}){const t=E("ToDo",o),e=new S;t.model=e;const s={width:h(100),rounding:r.rounding.r3,elevation:5,alignItems:"center",overflow:"hidden",border:r.border.thin};return A(q(t).append(J({padding:r.space.s6}).append(g({width:h(100),alignItems:"center"}).append(L("todos",{font:r.font.display_medium}),g(s).append(ot(e),y({width:h(95)}),at(e,t.maxWidth||O(100)),y({width:h(99)}),rt(e)),w(r.space.s6),st(e))),K(e.toastItems,{placement:Q.center,maxItems:1,duration:1500})))}function ut(){return X(dt)}const dt={sourceDir:"/source/Demos/ToDo",sections:[{title:"ToDo",componentFn:()=>ct(),sources:["View/ToDo.ts","View/ToDoButtonBar.ts","View/ToDoInputRow.ts","View/ToDoItemList.ts","View/ToDoItemRow.ts","View/ToDoStoreSelector.ts","Model/ToDoModel.ts","Data/ToDoData.ts"],markdown:"ToDo.md"}]};export{ut as ToDoDemo,ut as default};
